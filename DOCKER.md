# üê≥ Docker –¥–ª—è Homework Bot

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Homework Bot.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker 20.10+
- Docker Compose 2.0+
- Git

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/your-username/homework-bot.git
cd homework-bot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:
```env
BOT_TOKEN=your_bot_token_here
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_MODEL=meta-llama/llama-3.1-8b-instruct:free
LOG_LEVEL=1
LOG_DIR=/app/logs
```

### 3. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
```bash
# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build

# –ó–∞–ø—É—Å–∫ —Å Docker Compose
docker-compose up -d

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
homework-bot/
‚îú‚îÄ‚îÄ Dockerfile                 # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml         # –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ docker-compose.prod.yml    # –ü—Ä–æ–¥–∞–∫—à–Ω —Å registry
‚îú‚îÄ‚îÄ docker-compose.direct.yml  # –ü—Ä—è–º–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ dist/                      # –°–æ–±—Ä–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ temp/                      # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (volumes)
‚îú‚îÄ‚îÄ logs/                      # –õ–æ–≥–∏ (volumes)
‚îî‚îÄ‚îÄ .env                       # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|-------------|
| `BOT_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | - |
| `OPENROUTER_API_KEY` | –ö–ª—é—á API OpenRouter | - |
| `OPENROUTER_MODEL` | –ú–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ | `meta-llama/llama-3.1-8b-instruct:free` |
| `LOG_LEVEL` | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (0-3) | `1` |
| `LOG_DIR` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ª–æ–≥–æ–≤ | `/app/logs` |

### Volumes

- `./temp:/app/temp` - –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `./logs:/app/logs` - –§–∞–π–ª—ã –ª–æ–≥–æ–≤

### –ü–æ—Ä—Ç—ã

- `3000` - HTTP –ø–æ—Ä—Ç (–∑–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã Docker

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
docker-compose pull

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker-compose build
```

### –û—Ç–ª–∞–¥–∫–∞
```bash
# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose exec homework-bot sh

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
docker-compose logs -f | grep ERROR

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats homework-bot-container
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏
docker-compose logs --tail=100

# –°–ª–µ–∂–µ–Ω–∏–µ –∑–∞ –ª–æ–≥–∞–º–∏
docker-compose logs -f

# –õ–æ–≥–∏ –æ—à–∏–±–æ–∫
docker-compose logs | grep ERROR
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats homework-bot-container

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker inspect homework-bot-container
```

## üö® –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### –í–∞—Ä–∏–∞–Ω—Ç 1: GitHub Container Registry (GHCR)

1. **–û–±–Ω–æ–≤–∏—Ç–µ `docker-compose.prod.yml`:**
```yaml
image: ghcr.io/your-username/homework-bot/homework-bot:latest
```

2. **–ó–∞–ø—É—Å–∫:**
```bash
cp docker-compose.prod.yml docker-compose.yml
docker-compose pull
docker-compose up -d
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. **–ö–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä**
2. **–ó–∞–ø—É—Å–∫:**
```bash
cp docker-compose.direct.yml docker-compose.yml
docker-compose build
docker-compose up -d
```

## üîß –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π OpenRouter:

```env
OPENROUTER_MODEL=openai/gpt-4-vision-preview
OPENROUTER_API_KEY=your_openrouter_api_key_here
```

## üßπ –û—á–∏—Å—Ç–∫–∞

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker image prune -f

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker container prune -f

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Docker
docker system prune -a -f
```

## ‚ùó –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **"Cannot find module"**
   - –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ `npm run build` –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–∞–ø–∫–∞ `dist/` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

2. **"Permission denied"**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–∞–º `temp/` –∏ `logs/`
   ```bash
   chmod 755 temp logs
   ```

3. **"Image not found"**
   - –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –æ–±—Ä–∞–∑ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ registry
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ registry

4. **"OpenRouter API error"**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `OPENROUTER_API_KEY`
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –õ–æ–≥–∏ –æ—Ç–ª–∞–¥–∫–∏

```bash
# –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ Docker
docker-compose logs --details

# –õ–æ–≥–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
docker-compose logs -t

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs homework-bot
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Docker Documentation](https://docs.docker.com/)
- [Docker Compose Documentation](https://docs.docker.com/compose/)
- [GitHub Container Registry](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry)

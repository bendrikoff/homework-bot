# üîë –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å –≤—Ö–æ–¥–æ–º –ø–æ –ø–∞—Ä–æ–ª—é

## ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ!

–ü–∞–π–ø–ª–∞–π–Ω `deploy.yml` —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é** –≤–º–µ—Å—Ç–æ SSH –∫–ª—é—á–µ–π. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É.

## üîß –¢—Ä–µ–±—É–µ–º—ã–µ Github Secrets

–í–º–µ—Å—Ç–æ SSH –∫–ª—é—á–∞ —Ç–µ–ø–µ—Ä—å –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø–∞—Ä–æ–ª—å:

```env
SERVER_HOST     - IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.100)
SERVER_USER     - SSH –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä: root)
SERVER_PASSWORD - –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Ö–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä  
SERVER_PORT     - SSH –ø–æ—Ä—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 22)
```

## üìã –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–æ–¥–∏–Ω —Ä–∞–∑)

```bash
# SSH –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
ssh root@your-server

# –†–∞–∑—Ä–µ—à–∏—Ç—å –≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é (–µ—Å–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω)
sed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/' /etc/ssh/sshd_config
sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å SSH
systemctl restart sshd

# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ–∞–π—Ä–≤–æ–ª–ª —Ä–∞–∑—Ä–µ—à–∞–µ—Ç SSH
ufw allow ssh
ufw allow 22
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –£–∑–Ω–∞—Ç—å IP —Å–µ—Ä–≤–µ—Ä–∞
curl -s ifconfig.me
# –∏–ª–∏
ip addr show

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –ø–æ—Ä—Ç (–æ–±—ã—á–Ω–æ 22)
ss -tlnp | grep ssh

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è root (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
passwd root
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions**

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ secrets:

```
SERVER_HOST     = your-server-ip-address
SERVER_USER     = root
SERVER_PASSWORD = your-root-password  
SERVER_PORT     = 22  (–µ—Å–ª–∏ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π)
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞—â–∏—Ç–µ –ø–∞—Ä–æ–ª–µ–π:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏:**
   ```bash
   # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
   openssl rand -base64 32
   ```

2. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –ø–æ SSH:**
   ```bash
   # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å /etc/ssh/sshd_config
   sed -i 's/#AllowUsers.*/AllowUsers root/' /etc/ssh/sshd_config
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ fail2ban:**
   ```bash
   apt-get install fail2ban
   systemctl enable fail2ban
   systemctl start fail2ban
   ```

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –î–ª—è VPS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (DigitalOcean, Vultr, etc.):

```env
SERVER_HOST     = 164.92.xxx.xxx
SERVER_USER     = root  
SERVER_PASSWORD = your-vps-root-password
SERVER_PORT     = 22
```

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

```env
SERVER_HOST     = 192.168.1.100
SERVER_USER     = deployuser
SERVER_PASSWORD = your-secure-password
SERVER_PORT     = 2222  (–µ—Å–ª–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π)
```

### –î–ª—è VPS —Å –Ω–µ-root –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º:

```env
SERVER_HOST     = your-server.com
SERVER_USER     = ubuntu
SERVER_PASSWORD = your-user-password
SERVER_PORT     = 22
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–ª–∏—á–Ω–æ–≥–æ –æ—Ç `root` –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ sudo –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å home –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:

```bash
# –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ ubuntu –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo mkdir -p /opt/homework-bot
sudo chown ubuntu:ubuntu /opt/homework-bot
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@your-server-ip "echo 'SSH –¥–æ—Å—Ç—É–ø —Ä–∞–±–æ—Ç–∞–µ—Ç'"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–∞–π–ø–ª–∞–π–Ω–∞
# –°–¥–µ–ª–∞—Ç—å commit –≤ main –≤–µ—Ç–∫—É –∏ —Å–ª–µ–¥–∏—Ç—å –≤ GitHub Actions
```

### –ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
ssh root@your-server-ip

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker ps | grep homework-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
docker-compose -f /opt/homework-bot/docker-compose.yml ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose -f /opt/homework-bot/docker-compose.yml logs -f
```

## ‚ö° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã

### –ï—Å–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –∫–ª—é—á–∏:

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –ø–∞–π–ø–ª–∞–π–Ω—É `deploy-pm2.yml` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç SSH –∫–ª—é—á–∏):

```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –ø–∞–π–ø–ª–∞–π–Ω—ã —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏–ª–∏ GitHub:
# deploy.yml ‚Üí deploy-password.yml
# deploy-pm2.yml ‚Üí deploy.yml
```

### –ï—Å–ª–∏ –Ω—É–∂–µ–Ω PM2 –≤–º–µ—Å—Ç–æ Docker:

```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –ø–∞–π–ø–ª–∞–π–Ω –±–µ–∑ Docker:
# deploy.yml ‚Üí deploy-docker.yml  
# deploy-simple-backup.yml ‚Üí deploy.yml
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

‚ùå **"Permission denied (password)"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ SSH —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π—Ä–≤–æ–ª–ª –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç SSH

‚ùå **"Connection refused"**  
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SSH –ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ SSH —Å–ª—É–∂–±–∞ –∑–∞–ø—É—â–µ–Ω–∞

‚ùå **"Host key verification failed"**
```bash
ssh-keygen -R your-server-ip
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

- [ ] –°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ SSH —Å –ø–∞—Ä–æ–ª–µ–º
- [ ] GitHub Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (HOST, USER, PASSWORD, PORT)
- [ ] SSH —Å–ª—É–∂–±–∞ –∑–∞–ø—É—â–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ  
- [ ] –§–∞–π—Ä–≤–æ–ª–ª —Ä–∞–∑—Ä–µ—à–∞–µ—Ç SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- [ ] –ü–∞—Ä–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑–≤–µ—Å—Ç–µ–Ω –∏ —Å–ª–æ–∂–Ω—ã–π
- [ ] –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/opt/homework-bot` –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é! üöÄ**
